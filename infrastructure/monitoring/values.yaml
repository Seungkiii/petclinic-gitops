loki:
  deploymentMode: SingleBinary
  
  singleBinary:
    replicas: 1
    persistence:
      enabled: true
      storageClass: gp2
      size: 10Gi
  
  read:
    replicas: 0
  write:
    replicas: 0
  backend:
    replicas: 0
  
  serviceAccount:
    create: false
    name: "loki-sa"
  
  loki:
    auth_enabled: false
    
    commonConfig:
      replication_factor: 1
    
    storage:
      type: 's3'
      bucketNames:
        chunks: "petclinic-loki-storage-20251229"
        ruler: "petclinic-loki-storage-20251229"
        admin: "petclinic-loki-storage-20251229"
      s3:
        region: ap-northeast-2
        s3ForcePathStyle: false
    
    schemaConfig:
      configs:
        - from: 2024-01-01
          store: tsdb
          object_store: s3
          schema: v13
          index:
            prefix: index_
            period: 24h

promtail:
  config:
    clients:
      - url: http://monitoring-loki.monitoring.svc.cluster.local:3100/loki/api/v1/push

tempo:
  receivers:
    zipkin: {}
    jaeger:
      protocols:
        grpc:
          endpoint: 0.0.0.0:14250
        thrift_binary:
          endpoint: 0.0.0.0:6832
        thrift_compact:
          endpoint: 0.0.0.0:6831
        thrift_http:
          endpoint: 0.0.0.0:14268
    opencensus:
    otlp:
      protocols:
        grpc:
          endpoint: "0.0.0.0:4317"
        http:
          endpoint: "0.0.0.0:4318"
  
  storage:
    trace:
      backend: local
      local:
        path: /var/tempo/traces
  
  persistence:
    enabled: false
  
  serviceMonitor:
    enabled: true

alertmanager:
  enabled: true
  config:
    global:
      resolve_timeout: 5m
      slack_api_url: 'https://hooks.slack.com/services/YOUR/WEBHOOK/URL'  # ← 여기에 실제 Webhook URL
    
    route:
      group_by: ['alertname', 'severity']
      group_wait: 10s
      group_interval: 5m
      repeat_interval: 4h
      receiver: 'slack-scaling'
      
      routes:
        - match:
            severity: warning
          receiver: 'slack-scaling'
          repeat_interval: 4h
        
        - match:
            severity: info
          receiver: 'slack-info'
          repeat_interval: 12h
    
    receivers:
      - name: 'slack-scaling'
        slack_configs:
          - channel: '#petclinic-alerts'
            color: 'warning'
            title: '⚡ Scaling Alert'
            text: |-
              {{ range .Alerts }}
              *Alert:* {{ .Labels.alertname }}
              *Summary:* {{ .Annotations.summary }}
              *Description:* {{ .Annotations.description }}
              {{ end }}
            send_resolved: true
      
      - name: 'slack-info'
        slack_configs:
          - channel: '#petclinic-alerts'
            color: 'good'
            title: 'ℹ️ Info Alert'
            text: |-
              {{ range .Alerts }}
              *Alert:* {{ .Labels.alertname }}
              *Summary:* {{ .Annotations.summary }}
              {{ end }}
            send_resolved: true